# **Service-desk**

## **Требования**

### **Тикетная система**
- Есть клиенты — пользователи Telegram. Клиент пишет боту в Telegram сообщение, в системе создается новый тикет. У тикета есть минимум такие статусы: **Открыт**, **В работе**, **Закрыт**. Новый тикет, связанный с клиентом, создается только при условии, что предыдущий закрыт.
- Есть сотрудник, работающий в тикетной системе. Он может:
    - смотреть список тикетов (должна быть возможно фильтрации по статусу, сотруднику, сортировки по времени создания\обновления),
    - менять статус тикета. При смене статуса отправлять сообщение клиенту, что статус тикета сменился.

## **Технологии**

| Библиотека                  | Версия        |
|-----------------------------|---------------|
| python                      | 3.11          |
| fastapi                     | 0.105.0       |
| aiogram                     | 3.2.0         |
| uvicorn                     | 0.24.0[post1] |
| fastapi-users-db-sqlalchemy | 6.0.1         |
| alembic                     | 1.13.0        |
| sqlalchemy                  | 2.0.23        |
| aiohttp                     | 3.9.1         |
| aio-pika                    | 9.3.1         |
| rabbitmq                    | 0.2.0         |


## **Описание проекта**

Бот @NotOnlyLearnEnglishBot
Документация данного проекта доступна по адресу http://45.146.164.88:8000/docs/

Проект охватывает автоматизацию взаимодействия с ботом,
предоставляя эффективные инструменты для управления тикетами и обмена сообщениями.
При выполнении команды /start инициируется создание клиента.
При последующем взаимодействии формируется тикет, если у пользователя отсутствуют
открытые или находящиеся в работе тикеты. Кроме того, генерируется соответствующее сообщение.

Документация включает GET-запрос к эндпоинту "tickets" с возможностью фильтрации по статусу,
сотруднику, а также сортировки по времени создания и обновления. При изменении статуса тикета
автоматически отправляется уведомление в чат клиента, у которого открыт соответствующий тикет.
Список тикетов доступен только авторизованным пользователям, так же как и возможность изменения статуса тикета.
Нельзя изменять статус закрытых тикетов.

Система предоставляет возможность получения сообщений по идентификатору
тикета или отправки ответов в чат пользователя через API, требуется лишь знание ticket_id.
Реализация данного процесса выполняется с использованием брокера сообщений RabbitMQ.
Кроме того, реализован механизм аутентификации сотрудников с использованием JWT.


## Запуск через docker-compose

1. Установите python версии 3.11 и выше.
1. Установите docker и запустите его.
1. Клонируйте репозиторий и перейдите в него в командной строке:

    ```bash
    git clonehttps://github.com/LizaKoch/TZ-Foxford.git && \
    cd TZ-Foxford
    ```
   
1. Создайте файл .env и заполните его по примеру из файла .env.example (./ и в ./app/bot/):

   ```bash
   touch .env \ &&
   touch ./app/bot/.env
   ```

1. Перейдите в директорию infra и запустите docker-compose:

    ```bash
    cd infra && \
    docker-compose up -d
    ```

## **Примеры запросов API**

Полная документация доступна по ссылке <http://127.0.0.1:8000/docs/> после запуска проекта.
